"use strict";!function(){angular.module("app",["ngAnimate","ngMaterial","ngMessages","ui.router","LocalStorageModule","flow"])}(),function(){angular.module("app").config(["flowFactoryProvider",function(t){t.defaults={target:"/upload",permanentErrors:[404,500,501]},t.on("catchAll",function(t){})}])}(),function(){angular.module("app").config(["localStorageServiceProvider",function(t){t.setPrefix("app").setNotify(!0,!0)}])}(),function(){angular.module("app").config(["$stateProvider","$urlRouterProvider",function(t,o){o.otherwise("/"),t.state("main",{url:"/",views:{"":{templateUrl:"./build/templates/viewMain/viewMain.html"},"booksList@main":{templateUrl:"./build/templates/viewBooksList/viewBooksList.html"}}}).state("main.edit",{url:"book/edit/:id",views:{"booksList@main":{template:""},editBookView:{templateUrl:"./build/templates/viewEditBook/viewEditBook.html"}}}).state("main.create",{url:"book/create",views:{"booksList@main":{template:""},createBookView:{templateUrl:"./build/templates/viewCreateBook/viewCreateBook.html"}}}).state("main.form",{url:"form",views:{"booksList@main":{template:""},createBookView:{templateUrl:"./build/templates/form/index.html"}}})}])}(),function(){function t(t){this.$scope=t,this.init()}t.$inject=["$scope"],angular.module("app").controller("drBookCardCtrl",t),angular.module("app").directive("drBookCard",function(){function o(t,o,e,i){}return{link:o,restrict:"AEC",scope:{},templateUrl:"./build/templates/drBookCard/drBookCard.html",controller:t,controllerAs:"bCard",bindToController:{data:"=?",ctx:"=?",editLinkCb:"=?",deleteLinkCb:"=?"}}}),t.prototype.init=function(){this.editLinkCb||(this.editLinkCb=function(){}),this.deleteLinkCb||(this.deleteLinkCb=function(){})},t.prototype.editLink=function(t,o){t.preventDefault(),t.stopPropagation(),this.editLinkCb.call(this.ctx,o)},t.prototype.deleteLink=function(t,o){t.preventDefault(),t.stopPropagation(),this.deleteLinkCb.call(this.ctx,o)}}(),function(){function t(t){this.status="edit",this.$scope=t,this.init()}t.$inject=["$scope"],angular.module("app").controller("drBookEditorCtrl",t),angular.module("app").directive("drBookEditor",function(){function o(t,o,e,i){}return{link:o,restrict:"AEC",scope:{},templateUrl:"./build/templates/drBookEditor/drBookEditor.html",controller:t,controllerAs:"bkEdtr",bindToController:{data:"=?",ctx:"=",mode:"@?",saveCb:"=?"}}}),t.prototype.init=function(){this.mode&&"create"!==this.mode||(this.data={name:"",authors:[["",""]],pages:"",publishing_house:"",publication:"",edition:"",isbn:"",image:""}),this.returnIsbnConfig(this.data.isbn)},t.prototype.processFiles=function(t){var o=this;angular.forEach(t,function(t,e){var i=new FileReader;i.onload=function(t){var e=t.target.result;o.data.image=e,o.$scope.$digest()},i.readAsDataURL(t.file)})},t.prototype.saveCard=function(t){t.preventDefault(),t.stopPropagation(),console.log("---=== this.data ===---",this.data),this.mode&&"create"!=this.mode?this.saveCb.call(this.ctx):this.saveCb.call(this.ctx,this.data)},t.prototype.deleteAuthor=function(t,o){t.preventDefault(),t.stopPropagation(),this.data.authors.splice(o,1)},t.prototype.addAuthor=function(t){t.preventDefault(),t.stopPropagation(),this.data.authors.push(["",""])},t.prototype.returnIsbnConfig=function(t){console.log("---=== isbn ===---",this.data.isbn);var o=t;o=o.split("-"),this.isbnConfig=1==o[0].length?{length:13,pattern:"x-xxx-xxxxx-x",re:new RegExp("^(?:ISBN(?:-10)?:?●)?(?=[0-9X]{10}$|(?=(?:[0-9]+[-●]){3})[-●0-9X]{13}$)[0-9]{1,5}[-●]?[0-9]+[-●]?[0-9]+[-●]?[0-9X]$")}:{length:17,pattern:"9xx-x-xx-xxxxxx-x",re:new RegExp("^(?:ISBN(?:-13)?:?●)?(?=[0-9]{13}$|(?=(?:[0-9]+[-●]){4})[-●0-9]{17}$)97[89][-●]?[0-9]{1,5}[-●]?[0-9]+[-●]?[0-9]+[-●]?[0-9]$")}}}(),function(){function t(t){this.$scope=t,this.init()}t.$inject=["$scope"],angular.module("app").controller("drBookListCtrl",t),angular.module("app").directive("drBookList",function(){function o(t,o,e,i){}return{link:o,restrict:"AEC",scope:{},templateUrl:"./build/templates/drBookList/drBookList.html",controller:t,controllerAs:"bList",transclude:{bCard:"?drBookCard"},bindToController:{data:"=?",ctx:"="}}}),t.prototype.init=function(){}}(),function(){function t(t){this.$scope=t,this.init()}t.$inject=["$scope"],angular.module("app").controller("drSortBooksCtrl",t),angular.module("app").directive("drSortBooks",function(){function o(t,o,e,i){}return{link:o,restrict:"AEC",scope:{},templateUrl:"./build/templates/drSortBooks/drSortBooks.html",controller:t,controllerAs:"sb",bindToController:{data:"=?",ctx:"=?",clickCb:"=?",activeFilter:"=?",reverseStatus:"=?"}}}),t.prototype.init=function(){this.clickCb||(this.clickCb=function(){})},t.prototype.filterClick=function(t,o){t.preventDefault(),t.stopPropagation(),this.clickCb.call(this.ctx,o)}}(),function(){function t(t,o,e,i,r){this.$scope=t,this.$http=o,this.$state=e,this.localStorageService=r,this.bookList=this.localStorageService.get("bookList"),this.filters=[{name:"Названию",type:"name"},{name:"Автору",type:"_author"},{name:"Дате публикации",type:"publication"},{name:"Количеству страниц",type:"pages"}],this.init()}angular.module("app").controller("booksListCtrl",t),t.$inject=["$scope","$http","$state","$stateParams","localStorageService"],t.prototype.init=function(){this.getSortConfFromStorage()},t.prototype.getSortConfFromStorage=function(){var t=this.localStorageService.get("sortConf");t||(t={type:"name",reverse:!1},this.localStorageService.set("sortConf",t)),this.sortType=t.type,this.sortReverse=t.reverse},t.prototype.editBook=function(t){this.localStorageService.set("editBook",t),this.$state.go("main.edit",{id:t.id})},t.prototype.deleteBook=function(t){for(var o=0;o<this.bookList.length;o+=1)t.id===this.bookList[o].id&&this.bookList.splice(o,1);this.localStorageService.set("bookList",this.bookList)},t.prototype.addBook=function(t){t.preventDefault(),t.stopPropagation(),this.$state.go("main.create")},t.prototype.sortBooks=function(t){console.log("---=== type ===---",t),this.sortType===t?this.sortReverse=!this.sortReverse:(this.sortReverse=!1,this.sortType=t),this.localStorageService.set("sortConf",{type:this.sortType,reverse:this.sortReverse})},t.prototype.updateFromJson=function(t){var o=this;t.preventDefault(),t.stopPropagation(),this.$http.get("./src/fixtures/books.json").then(function(t){for(var e=0;e<t.data.length;e+=1)t.data[e]._author=t.data[e].authors[0].s_name;o.localStorageService.set("bookList",t.data),o.$state.reload()})}}(),function(){function t(t,o,e,i,r){this.$scope=t,this.$http=o,this.$state=e,this.localStorageService=r,this.init()}angular.module("app").controller("CreateBookCtrl",t),t.$inject=["$scope","$http","$state","$stateParams","localStorageService"],t.prototype.init=function(){this.book=angular.copy(this.localStorageService.get("editBook"))},t.prototype.saveBookCb=function(t){var o=this.localStorageService.get("bookList");t.id="_"+o.length,o.push(t),this.localStorageService.set("bookList",o),this.$state.go("main")}}(),function(){function t(t,o,e,i,r){this.$scope=t,this.$http=o,this.$state=e,this.localStorageService=r,this.init()}angular.module("app").controller("EditBookCtrl",t),t.$inject=["$scope","$http","$state","$stateParams","localStorageService"],t.prototype.init=function(){this.book=angular.copy(this.localStorageService.get("editBook"))},t.prototype.saveBookCb=function(){console.log("---=== callback ===---");for(var t=this.localStorageService.get("bookList"),o=0;o<t.length;o+=1)this.book.id==t[o].id&&(t[o]=this.book);this.localStorageService.set("bookList",t),this.localStorageService.remove("editBook"),this.$state.go("main")}}(),function(){function t(t,o,e,i,r){this.$scope=t,this.$http=o,this.$state=e,this.localStorageService=r,this.init()}angular.module("app").controller("mainCtrl",t),t.$inject=["$scope","$http","$state","$stateParams","localStorageService"],t.prototype.init=function(){this.getBooks()},t.prototype.getBooks=function(){var t=this;this.localStorageService.get("bookList")||this.$http.get("./src/fixtures/books.json").then(function(o){for(var e=0;e<o.data.length;e+=1)o.data[e]._author=o.data[e].authors[0].s_name;t.localStorageService.set("bookList",o.data)})}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiZmxvd0ZhY3RvcnlQcm92aWRlciIsImRlZmF1bHRzIiwidGFyZ2V0IiwicGVybWFuZW50RXJyb3JzIiwib24iLCJldmVudCIsImxvY2FsU3RvcmFnZVNlcnZpY2VQcm92aWRlciIsInNldFByZWZpeCIsInNldE5vdGlmeSIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ1cmwiLCJ2aWV3cyIsIiIsInRlbXBsYXRlVXJsIiwiYm9va3NMaXN0QG1haW4iLCJ0ZW1wbGF0ZSIsImVkaXRCb29rVmlldyIsImNyZWF0ZUJvb2tWaWV3IiwiZHJCb29rQ2FyZEN0cmwiLCIkc2NvcGUiLCJ0aGlzIiwiaW5pdCIsIiRpbmplY3QiLCJjb250cm9sbGVyIiwiZGlyZWN0aXZlIiwiZHJCb29rQ2FyZExpbmsiLCIkZWxlbWVudCIsIiRhdHRycyIsIiR0aW1lb3V0IiwibGluayIsInJlc3RyaWN0Iiwic2NvcGUiLCJjb250cm9sbGVyQXMiLCJiaW5kVG9Db250cm9sbGVyIiwiZGF0YSIsImN0eCIsImVkaXRMaW5rQ2IiLCJkZWxldGVMaW5rQ2IiLCJwcm90b3R5cGUiLCJlZGl0TGluayIsImUiLCJib29rIiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJjYWxsIiwiZGVsZXRlTGluayIsImRyQm9va0VkaXRvckN0cmwiLCJzdGF0dXMiLCJkckJvb2tFZGl0b3JMaW5rIiwibW9kZSIsInNhdmVDYiIsIm5hbWUiLCJhdXRob3JzIiwicGFnZXMiLCJwdWJsaXNoaW5nX2hvdXNlIiwicHVibGljYXRpb24iLCJlZGl0aW9uIiwiaXNibiIsImltYWdlIiwicmV0dXJuSXNibkNvbmZpZyIsInByb2Nlc3NGaWxlcyIsImZpbGVzIiwiX3RoaXMiLCJmb3JFYWNoIiwiZmxvd0ZpbGUiLCJpIiwiZmlsZVJlYWRlciIsIkZpbGVSZWFkZXIiLCJvbmxvYWQiLCJ1cmkiLCJyZXN1bHQiLCIkZGlnZXN0IiwicmVhZEFzRGF0YVVSTCIsImZpbGUiLCJzYXZlQ2FyZCIsImNvbnNvbGUiLCJsb2ciLCJkZWxldGVBdXRob3IiLCJpZHgiLCJzcGxpY2UiLCJhZGRBdXRob3IiLCJwdXNoIiwiYXJyIiwic3BsaXQiLCJpc2JuQ29uZmlnIiwibGVuZ3RoIiwicGF0dGVybiIsInJlIiwiUmVnRXhwIiwiZHJCb29rTGlzdEN0cmwiLCJkckJvb2tMaXN0TGluayIsInRyYW5zY2x1ZGUiLCJiQ2FyZCIsImRyU29ydEJvb2tzQ3RybCIsImRyU29ydEJvb2tzTGluayIsImNsaWNrQ2IiLCJhY3RpdmVGaWx0ZXIiLCJyZXZlcnNlU3RhdHVzIiwiZmlsdGVyQ2xpY2siLCJmaWx0ZXJUeXBlIiwiYm9va3NMaXN0Q3RybCIsIiRodHRwIiwiJHN0YXRlIiwiJHN0YXRlUGFyYW1zIiwibG9jYWxTdG9yYWdlU2VydmljZSIsImJvb2tMaXN0IiwiZ2V0IiwiZmlsdGVycyIsInR5cGUiLCJnZXRTb3J0Q29uZkZyb21TdG9yYWdlIiwic29ydENvbmYiLCJyZXZlcnNlIiwic2V0Iiwic29ydFR5cGUiLCJzb3J0UmV2ZXJzZSIsImVkaXRCb29rIiwiZ28iLCJpZCIsImRlbGV0ZUJvb2siLCJhZGRCb29rIiwic29ydEJvb2tzIiwidXBkYXRlRnJvbUpzb24iLCJ0aGVuIiwicmVzcCIsIl9hdXRob3IiLCJyZWxvYWQiLCJDcmVhdGVCb29rQ3RybCIsImNvcHkiLCJzYXZlQm9va0NiIiwibmV3Qm9vayIsImJvb2tzIiwiRWRpdEJvb2tDdHJsIiwicmVtb3ZlIiwibWFpbkN0cmwiLCJnZXRCb29rcyJdLCJtYXBwaW5ncyI6IkFBQUEsY0FFQSxXQUNDQSxRQUFRQyxPQUFPLE9BQVEsWUFBYSxhQUFjLGFBQWMsWUFBYSxxQkFBc0IsWUFJcEcsV0FDQ0QsUUFBUUMsT0FBTyxPQUFPQyxRQUFRLHNCQUF1QixTQUFVQyxHQUM5REEsRUFBb0JDLFVBQ25CQyxPQUFRLFVBQ1JDLGlC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QUFTL0YsVUFBVWdHLFNBQVcsV0FDN0IsR0FBSXhFLEdBQVExQyxJQUVQQSxNQUFLb0Ysb0JBQW9CRSxJQUFJLGFBQ2pDdEYsS0FBS2lGLE1BQU1LLElBQUksNkJBQTZCZ0IsS0FBSyxTQUFVQyxHQUMxRCxJQUFLLEdBQUkxRCxHQUFJLEVBQUdBLEVBQUkwRCxFQUFLekYsS0FBS21ELE9BQVFwQixHQUFLLEVBQzFDMEQsRUFBS3pGLEtBQUsrQixHQUFHMkQsUUFBVUQsRUFBS3pGLEtBQUsrQixHQUFHYixRQUFRLEdBQVcsTUFFeERVLEdBQU0wQyxvQkFBb0JRLElBQUksV0FBWVcsRUFBS3pGIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdBbmltYXRlJywgJ25nTWF0ZXJpYWwnLCAnbmdNZXNzYWdlcycsICd1aS5yb3V0ZXInLCAnTG9jYWxTdG9yYWdlTW9kdWxlJywgJ2Zsb3cnXSk7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29uZmlnKFsnZmxvd0ZhY3RvcnlQcm92aWRlcicsIGZ1bmN0aW9uIChmbG93RmFjdG9yeVByb3ZpZGVyKSB7XG5cdFx0Zmxvd0ZhY3RvcnlQcm92aWRlci5kZWZhdWx0cyA9IHtcblx0XHRcdHRhcmdldDogJy91cGxvYWQnLFxuXHRcdFx0cGVybWFuZW50RXJyb3JzOiBbNDA0LCA1MDAsIDUwMV1cblx0XHR9O1xuXHRcdGZsb3dGYWN0b3J5UHJvdmlkZXIub24oJ2NhdGNoQWxsJywgZnVuY3Rpb24gKGV2ZW50KSB7fSk7XG5cdH1dKTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb25maWcoW1wibG9jYWxTdG9yYWdlU2VydmljZVByb3ZpZGVyXCIsIGZ1bmN0aW9uIChsb2NhbFN0b3JhZ2VTZXJ2aWNlUHJvdmlkZXIpIHtcblx0XHRsb2NhbFN0b3JhZ2VTZXJ2aWNlUHJvdmlkZXIuc2V0UHJlZml4KCdhcHAnKS5zZXROb3RpZnkodHJ1ZSwgdHJ1ZSk7XG5cdH1dKTtcbn0pKCk7XG5cInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbmZpZyhbXCIkc3RhdGVQcm92aWRlclwiLCBcIiR1cmxSb3V0ZXJQcm92aWRlclwiLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXHRcdHZhciBwYXRoVG9Db21wb25lbnRzID0gJy4vc3JjL2NvbXBvbmVudHMvJztcblxuXHRcdCR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcblxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdtYWluJywge1xuXHRcdFx0dXJsOiAnLycsXG5cdFx0XHR2aWV3czoge1xuXHRcdFx0XHRcIlwiOiB7XG5cdFx0XHRcdFx0dGVtcGxhdGVVcmw6ICcuL2J1aWxkL3RlbXBsYXRlcy92aWV3TWFpbi92aWV3TWFpbi5odG1sJ1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRcImJvb2tzTGlzdEBtYWluXCI6IHtcblx0XHRcdFx0XHR0ZW1wbGF0ZVVybDogJy4vYnVpbGQvdGVtcGxhdGVzL3ZpZXdCb29rc0xpc3Qvdmlld0Jvb2tzTGlzdC5odG1sJ1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSkuc3RhdGUoJ21haW4uZWRpdCcsIHtcblx0XHRcdHVybDogJ2Jvb2svZWRpdC86aWQnLFxuXHRcdFx0dmlld3M6IHtcblx0XHRcdFx0XCJib29rc0xpc3RAbWFpblwiOiB7XG5cdFx0XHRcdFx0dGVtcGxhdGU6ICcnXG5cdFx0XHRcdH0sXG5cdFx0XHRcdFwiZWRpdEJvb2tWaWV3XCI6IHtcblx0XHRcdFx0XHR0ZW1wbGF0ZVVybDogJy4vYnVpbGQvdGVtcGxhdGVzL3ZpZXdFZGl0Qm9vay92aWV3RWRpdEJvb2suaHRtbCdcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pLnN0YXRlKCdtYWluLmNyZWF0ZScsIHtcblx0XHRcdHVybDogJ2Jvb2svY3JlYXRlJyxcblx0XHRcdHZpZXdzOiB7XG5cdFx0XHRcdFwiYm9va3NMaXN0QG1haW5cIjoge1xuXHRcdFx0XHRcdHRlbXBsYXRlOiAnJ1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRcImNyZWF0ZUJvb2tWaWV3XCI6IHtcblx0XHRcdFx0XHR0ZW1wbGF0ZVVybDogJy4vYnVpbGQvdGVtcGxhdGVzL3ZpZXdDcmVhdGVCb29rL3ZpZXdDcmVhdGVCb29rLmh0bWwnXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KS5zdGF0ZSgnbWFpbi5mb3JtJywge1xuXHRcdFx0dXJsOiAnZm9ybScsXG5cdFx0XHR2aWV3czoge1xuXHRcdFx0XHRcImJvb2tzTGlzdEBtYWluXCI6IHtcblx0XHRcdFx0XHR0ZW1wbGF0ZTogJydcblx0XHRcdFx0fSxcblx0XHRcdFx0XCJjcmVhdGVCb29rVmlld1wiOiB7XG5cdFx0XHRcdFx0dGVtcGxhdGVVcmw6ICcuL2J1aWxkL3RlbXBsYXRlcy9mb3JtL2luZGV4Lmh0bWwnXG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fV0pO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHt9KTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0ZHJCb29rQ2FyZEN0cmwuJGluamVjdCA9IFtcIiRzY29wZVwiXTtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ2RyQm9va0NhcmRDdHJsJywgZHJCb29rQ2FyZEN0cmwpO1xuXG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5kaXJlY3RpdmUoJ2RyQm9va0NhcmQnLCBmdW5jdGlvbiAoKSB7XG5cdFx0ZnVuY3Rpb24gZHJCb29rQ2FyZExpbmsoJHNjb3BlLCAkZWxlbWVudCwgJGF0dHJzLCAkdGltZW91dCkge31cblxuXHRcdHJldHVybiB7XG5cdFx0XHRsaW5rOiBkckJvb2tDYXJkTGluayxcblx0XHRcdHJlc3RyaWN0OiAnQUVDJyxcblx0XHRcdHNjb3BlOiB7fSxcblx0XHRcdHRlbXBsYXRlVXJsOiAnLi9idWlsZC90ZW1wbGF0ZXMvZHJCb29rQ2FyZC9kckJvb2tDYXJkLmh0bWwnLFxuXHRcdFx0Y29udHJvbGxlcjogZHJCb29rQ2FyZEN0cmwsXG5cdFx0XHRjb250cm9sbGVyQXM6ICdiQ2FyZCcsXG5cdFx0XHRiaW5kVG9Db250cm9sbGVyOiB7XG5cdFx0XHRcdGRhdGE6ICc9PycsXG5cdFx0XHRcdGN0eDogJz0/Jyxcblx0XHRcdFx0ZWRpdExpbmtDYjogJz0/Jyxcblx0XHRcdFx0ZGVsZXRlTGlua0NiOiAnPT8nXG5cdFx0XHR9XG5cdFx0fTtcblx0fSk7XG5cblx0ZnVuY3Rpb24gZHJCb29rQ2FyZEN0cmwoJHNjb3BlKSB7XG5cdFx0dGhpcy4kc2NvcGUgPSAkc2NvcGU7XG5cblx0XHR0aGlzLmluaXQoKTtcblx0fVxuXG5cdGRyQm9va0NhcmRDdHJsLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuXHRcdGlmICghdGhpcy5lZGl0TGlua0NiKSB0aGlzLmVkaXRMaW5rQ2IgPSBmdW5jdGlvbiAoKSB7fTtcblx0XHRpZiAoIXRoaXMuZGVsZXRlTGlua0NiKSB0aGlzLmRlbGV0ZUxpbmtDYiA9IGZ1bmN0aW9uICgpIHt9O1xuXHR9O1xuXG5cdC8qKlxuICAqINCk0YPQvdC60YbQuNGPINC60LvQuNC60LAg0L/QviDQuNC60L7QvdC60LUg0YDQtdC00LDQutGC0LjRgNC+0LLQsNC90LjRjyDQutC90LjQs9C4INCyINC60LDRgNGC0L7Rh9C60LUuINCS0YvQt9GL0LLQsNC10YIg0L/QtdGA0LXQtNCw0L3QvdGL0Lkg0LrQvtC70LvQsdC10Log0LjQu9C4ICgpPXt9XG4gICogQHBhcmFtIGVcbiAgKiBAcGFyYW0gYm9va1xuICAqL1xuXHRkckJvb2tDYXJkQ3RybC5wcm90b3R5cGUuZWRpdExpbmsgPSBmdW5jdGlvbiAoZSwgYm9vaykge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0dGhpcy5lZGl0TGlua0NiLmNhbGwodGhpcy5jdHgsIGJvb2spO1xuXHR9O1xuXG5cdC8qKlxuICAqINCk0YPQvdC60YbQuNGPINC60LvQuNC60LAg0L/QviDQuNC60L7QvdC60LUg0YPQtNCw0LvQtdC90LjRjyDQutC90LjQs9C4INCyINC60LDRgNGC0L7Rh9C60LUuINCS0YvQt9GL0LLQsNC10YIg0L/QtdGA0LXQtNCw0L3QvdGL0Lkg0LrQvtC70LvQsdC10Log0LjQu9C4ICgpPXt9XG4gICogQHBhcmFtIGVcbiAgKiBAcGFyYW0gYm9va1xuICAqL1xuXHRkckJvb2tDYXJkQ3RybC5wcm90b3R5cGUuZGVsZXRlTGluayA9IGZ1bmN0aW9uIChlLCBib29rKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHR0aGlzLmRlbGV0ZUxpbmtDYi5jYWxsKHRoaXMuY3R4LCBib29rKTtcblx0fTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdGRyQm9va0VkaXRvckN0cmwuJGluamVjdCA9IFtcIiRzY29wZVwiXTtcblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ2RyQm9va0VkaXRvckN0cmwnLCBkckJvb2tFZGl0b3JDdHJsKTtcblxuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuZGlyZWN0aXZlKCdkckJvb2tFZGl0b3InLCBmdW5jdGlvbiAoKSB7XG5cdFx0ZnVuY3Rpb24gZHJCb29rRWRpdG9yTGluaygkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICR0aW1lb3V0KSB7fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGxpbms6IGRyQm9va0VkaXRvckxpbmssXG5cdFx0XHRyZXN0cmljdDogJ0FFQycsXG5cdFx0XHRzY29wZToge30sXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy4vYnVpbGQvdGVtcGxhdGVzL2RyQm9va0VkaXRvci9kckJvb2tFZGl0b3IuaHRtbCcsXG5cdFx0XHRjb250cm9sbGVyOiBkckJvb2tFZGl0b3JDdHJsLFxuXHRcdFx0Y29udHJvbGxlckFzOiAnYmtFZHRyJyxcblx0XHRcdGJpbmRUb0NvbnRyb2xsZXI6IHtcblx0XHRcdFx0ZGF0YTogJz0/Jyxcblx0XHRcdFx0Y3R4OiAnPScsXG5cdFx0XHRcdG1vZGU6ICdAPycsXG5cdFx0XHRcdHNhdmVDYjogJz0/J1xuXHRcdFx0fVxuXHRcdH07XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGRyQm9va0VkaXRvckN0cmwoJHNjb3BlKSB7XG5cdFx0dGhpcy5zdGF0dXMgPSAnZWRpdCc7XG5cdFx0dGhpcy4kc2NvcGUgPSAkc2NvcGU7XG5cblx0XHR0aGlzLmluaXQoKTtcblx0fVxuXG5cdGRyQm9va0VkaXRvckN0cmwucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0aWYgKCF0aGlzLm1vZGUgfHwgdGhpcy5tb2RlID09PSAnY3JlYXRlJykgdGhpcy5kYXRhID0ge1xuXHRcdFx0bmFtZTogXCJcIixcblx0XHRcdGF1dGhvcnM6IFtbXCJcIiwgXCJcIl1dLFxuXHRcdFx0cGFnZXM6IFwiXCIsXG5cdFx0XHRwdWJsaXNoaW5nX2hvdXNlOiBcIlwiLFxuXHRcdFx0cHVibGljYXRpb246IFwiXCIsXG5cdFx0XHRlZGl0aW9uOiBcIlwiLFxuXHRcdFx0aXNibjogXCJcIixcblx0XHRcdGltYWdlOiBcIlwiXG5cdFx0fTtcblxuXHRcdHRoaXMucmV0dXJuSXNibkNvbmZpZyh0aGlzLmRhdGEuaXNibik7XG5cdH07XG5cblx0ZHJCb29rRWRpdG9yQ3RybC5wcm90b3R5cGUucHJvY2Vzc0ZpbGVzID0gZnVuY3Rpb24gKGZpbGVzKSB7XG5cdFx0dmFyIF90aGlzID0gdGhpcztcblxuXHRcdGFuZ3VsYXIuZm9yRWFjaChmaWxlcywgZnVuY3Rpb24gKGZsb3dGaWxlLCBpKSB7XG5cdFx0XHR2YXIgZmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cdFx0XHRmaWxlUmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChldmVudCkge1xuXHRcdFx0XHR2YXIgdXJpID0gZXZlbnQudGFyZ2V0LnJlc3VsdDtcblx0XHRcdFx0X3RoaXMuZGF0YS5pbWFnZSA9IHVyaTtcblx0XHRcdFx0X3RoaXMuJHNjb3BlLiRkaWdlc3QoKTtcblx0XHRcdH07XG5cdFx0XHRmaWxlUmVhZGVyLnJlYWRBc0RhdGFVUkwoZmxvd0ZpbGUuZmlsZSk7XG5cdFx0fSk7XG5cdH07XG5cblx0ZHJCb29rRWRpdG9yQ3RybC5wcm90b3R5cGUuc2F2ZUNhcmQgPSBmdW5jdGlvbiAoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0Y29uc29sZS5sb2coJy0tLT09PSB0aGlzLmRhdGEgPT09LS0tJywgdGhpcy5kYXRhKTtcblxuXHRcdGlmICghdGhpcy5tb2RlIHx8IHRoaXMubW9kZSA9PSAnY3JlYXRlJykge1xuXHRcdFx0dGhpcy5zYXZlQ2IuY2FsbCh0aGlzLmN0eCwgdGhpcy5kYXRhKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5zYXZlQ2IuY2FsbCh0aGlzLmN0eCk7XG5cdFx0fVxuXHR9O1xuXG5cdGRyQm9va0VkaXRvckN0cmwucHJvdG90eXBlLmRlbGV0ZUF1dGhvciA9IGZ1bmN0aW9uIChlLCBpZHgpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuXHRcdHRoaXMuZGF0YS5hdXRob3JzLnNwbGljZShpZHgsIDEpO1xuXHR9O1xuXG5cdGRyQm9va0VkaXRvckN0cmwucHJvdG90eXBlLmFkZEF1dGhvciA9IGZ1bmN0aW9uIChlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHR0aGlzLmRhdGEuYXV0aG9ycy5wdXNoKFtcIlwiLCBcIlwiXSk7XG5cdH07XG5cblx0ZHJCb29rRWRpdG9yQ3RybC5wcm90b3R5cGUucmV0dXJuSXNibkNvbmZpZyA9IGZ1bmN0aW9uIChpc2JuKSB7XG5cdFx0Y29uc29sZS5sb2coJy0tLT09PSBpc2JuID09PS0tLScsIHRoaXMuZGF0YS5pc2JuKTtcblx0XHR2YXIgYXJyID0gaXNibjtcblx0XHRhcnIgPSBhcnIuc3BsaXQoJy0nKTtcblx0XHR0aGlzLmlzYm5Db25maWcgPSBhcnJbMF0ubGVuZ3RoID09IDEgPyB7XG5cdFx0XHRsZW5ndGg6IDEzLFxuXHRcdFx0cGF0dGVybjogJ3gteHh4LXh4eHh4LXgnLFxuXHRcdFx0cmU6IG5ldyBSZWdFeHAoJ14oPzpJU0JOKD86LTEwKT86P+KXjyk/KD89WzAtOVhdezEwfSR8KD89KD86WzAtOV0rWy3il49dKXszfSlbLeKXjzAtOVhdezEzfSQpWzAtOV17MSw1fVst4pePXT9bMC05XStbLeKXj10/WzAtOV0rWy3il49dP1swLTlYXSQnKVxuXHRcdH0gOiB7XG5cdFx0XHRsZW5ndGg6IDE3LFxuXHRcdFx0cGF0dGVybjogJzl4eC14LXh4LXh4eHh4eC14Jyxcblx0XHRcdHJlOiBuZXcgUmVnRXhwKCdeKD86SVNCTig/Oi0xMyk/Oj/il48pPyg/PVswLTldezEzfSR8KD89KD86WzAtOV0rWy3il49dKXs0fSlbLeKXjzAtOV17MTd9JCk5N1s4OV1bLeKXj10/WzAtOV17MSw1fVst4pePXT9bMC05XStbLeKXj10/WzAtOV0rWy3il49dP1swLTldJCcpXG5cdFx0fTtcblx0fTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdGRyQm9va0xpc3RDdHJsLiRpbmplY3QgPSBbXCIkc2NvcGVcIl07XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdkckJvb2tMaXN0Q3RybCcsIGRyQm9va0xpc3RDdHJsKTtcblxuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuZGlyZWN0aXZlKCdkckJvb2tMaXN0JywgZnVuY3Rpb24gKCkge1xuXHRcdGZ1bmN0aW9uIGRyQm9va0xpc3RMaW5rKCRzY29wZSwgJGVsZW1lbnQsICRhdHRycywgJHRpbWVvdXQpIHt9XG5cblx0XHRyZXR1cm4ge1xuXHRcdFx0bGluazogZHJCb29rTGlzdExpbmssXG5cdFx0XHRyZXN0cmljdDogJ0FFQycsXG5cdFx0XHRzY29wZToge30sXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy4vYnVpbGQvdGVtcGxhdGVzL2RyQm9va0xpc3QvZHJCb29rTGlzdC5odG1sJyxcblx0XHRcdGNvbnRyb2xsZXI6IGRyQm9va0xpc3RDdHJsLFxuXHRcdFx0Y29udHJvbGxlckFzOiAnYkxpc3QnLFxuXHRcdFx0dHJhbnNjbHVkZToge1xuXHRcdFx0XHQnYkNhcmQnOiAnP2RyQm9va0NhcmQnXG5cdFx0XHR9LFxuXHRcdFx0YmluZFRvQ29udHJvbGxlcjoge1xuXHRcdFx0XHRkYXRhOiAnPT8nLFxuXHRcdFx0XHRjdHg6ICc9J1xuXHRcdFx0fVxuXHRcdH07XG5cdH0pO1xuXG5cdGZ1bmN0aW9uIGRyQm9va0xpc3RDdHJsKCRzY29wZSkge1xuXHRcdHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuXG5cdFx0dGhpcy5pbml0KCk7XG5cdH1cblxuXHRkckJvb2tMaXN0Q3RybC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHt9O1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxuKGZ1bmN0aW9uICgpIHtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0ZHJTb3J0Qm9va3NDdHJsLiRpbmplY3QgPSBbXCIkc2NvcGVcIl07XG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5jb250cm9sbGVyKCdkclNvcnRCb29rc0N0cmwnLCBkclNvcnRCb29rc0N0cmwpO1xuXG5cdGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5kaXJlY3RpdmUoJ2RyU29ydEJvb2tzJywgZnVuY3Rpb24gKCkge1xuXHRcdGZ1bmN0aW9uIGRyU29ydEJvb2tzTGluaygkc2NvcGUsICRlbGVtZW50LCAkYXR0cnMsICR0aW1lb3V0KSB7fVxuXG5cdFx0cmV0dXJuIHtcblx0XHRcdGxpbms6IGRyU29ydEJvb2tzTGluayxcblx0XHRcdHJlc3RyaWN0OiAnQUVDJyxcblx0XHRcdHNjb3BlOiB7fSxcblx0XHRcdHRlbXBsYXRlVXJsOiAnLi9idWlsZC90ZW1wbGF0ZXMvZHJTb3J0Qm9va3MvZHJTb3J0Qm9va3MuaHRtbCcsXG5cdFx0XHRjb250cm9sbGVyOiBkclNvcnRCb29rc0N0cmwsXG5cdFx0XHRjb250cm9sbGVyQXM6ICdzYicsXG5cdFx0XHRiaW5kVG9Db250cm9sbGVyOiB7XG5cdFx0XHRcdGRhdGE6ICc9PycsXG5cdFx0XHRcdGN0eDogJz0/Jyxcblx0XHRcdFx0Y2xpY2tDYjogJz0/Jyxcblx0XHRcdFx0YWN0aXZlRmlsdGVyOiAnPT8nLFxuXHRcdFx0XHRyZXZlcnNlU3RhdHVzOiAnPT8nXG5cdFx0XHR9XG5cdFx0fTtcblx0fSk7XG5cblx0ZnVuY3Rpb24gZHJTb3J0Qm9va3NDdHJsKCRzY29wZSkge1xuXHRcdHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuXG5cdFx0dGhpcy5pbml0KCk7XG5cdH1cblxuXHRkclNvcnRCb29rc0N0cmwucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0aWYgKCF0aGlzLmNsaWNrQ2IpIHRoaXMuY2xpY2tDYiA9IGZ1bmN0aW9uICgpIHt9O1xuXHR9O1xuXG5cdC8qKlxuICAqINCa0LvQuNC6INC/0L4g0YTQuNC70YzRgtGA0YMuINCS0YvQt9GL0LLQsNC10Lwg0L/QtdGA0LXQtNCw0L3QvdGL0Lkg0LrQvtC70LvQsdC10Log0LjQu9C4ICgpPT57fVxuICAqIEBwYXJhbSBlXG4gICogQHBhcmFtIGZpbHRlclR5cGVcbiAgKi9cblx0ZHJTb3J0Qm9va3NDdHJsLnByb3RvdHlwZS5maWx0ZXJDbGljayA9IGZ1bmN0aW9uIChlLCBmaWx0ZXJUeXBlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHR0aGlzLmNsaWNrQ2IuY2FsbCh0aGlzLmN0eCwgZmlsdGVyVHlwZSk7XG5cdH07XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHQndXNlIHN0cmljdCc7XG5cblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ2Jvb2tzTGlzdEN0cmwnLCBib29rc0xpc3RDdHJsKTtcblxuXHRib29rc0xpc3RDdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckaHR0cCcsICckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ2xvY2FsU3RvcmFnZVNlcnZpY2UnXTtcblxuXHRmdW5jdGlvbiBib29rc0xpc3RDdHJsKCRzY29wZSwgJGh0dHAsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBsb2NhbFN0b3JhZ2VTZXJ2aWNlKSB7XG5cdFx0dGhpcy4kc2NvcGUgPSAkc2NvcGU7XG5cdFx0dGhpcy4kaHR0cCA9ICRodHRwO1xuXHRcdHRoaXMuJHN0YXRlID0gJHN0YXRlO1xuXHRcdHRoaXMubG9jYWxTdG9yYWdlU2VydmljZSA9IGxvY2FsU3RvcmFnZVNlcnZpY2U7XG5cblx0XHR0aGlzLmJvb2tMaXN0ID0gdGhpcy5sb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgnYm9va0xpc3QnKTtcblxuXHRcdHRoaXMuZmlsdGVycyA9IFt7IG5hbWU6ICfQndCw0LfQstCw0L3QuNGOJywgdHlwZTogJ25hbWUnIH0sIHsgbmFtZTogJ9CQ0LLRgtC+0YDRgycsIHR5cGU6ICdfYXV0aG9yJyB9LCB7IG5hbWU6ICfQlNCw0YLQtSDQv9GD0LHQu9C40LrQsNGG0LjQuCcsIHR5cGU6ICdwdWJsaWNhdGlvbicgfSwgeyBuYW1lOiAn0JrQvtC70LjRh9C10YHRgtCy0YMg0YHRgtGA0LDQvdC40YYnLCB0eXBlOiAncGFnZXMnIH1dO1xuXG5cdFx0dGhpcy5pbml0KCk7XG5cdH1cblxuXHRib29rc0xpc3RDdHJsLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuXHRcdHRoaXMuZ2V0U29ydENvbmZGcm9tU3RvcmFnZSgpO1xuXHR9O1xuXG5cdGJvb2tzTGlzdEN0cmwucHJvdG90eXBlLmdldFNvcnRDb25mRnJvbVN0b3JhZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIHNvcnRDb25mID0gdGhpcy5sb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgnc29ydENvbmYnKTtcblx0XHRpZiAoIXNvcnRDb25mKSB7XG5cdFx0XHRzb3J0Q29uZiA9IHsgdHlwZTogJ25hbWUnLCByZXZlcnNlOiBmYWxzZSB9O1xuXHRcdFx0dGhpcy5sb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnc29ydENvbmYnLCBzb3J0Q29uZik7XG5cdFx0fVxuXHRcdHRoaXMuc29ydFR5cGUgPSBzb3J0Q29uZi50eXBlO1xuXHRcdHRoaXMuc29ydFJldmVyc2UgPSBzb3J0Q29uZi5yZXZlcnNlO1xuXHR9O1xuXG5cdC8qKlxuICAqINCk0YPQvdC60YbQuNGPINC/0LXRgNC10YXQvtC00LAg0LIg0YDQtdC00LDQutGC0L7RgCDQutC90LjQs9C4XG4gICog0J/QtdGA0LXQtNCw0LXRgtGB0Y8g0LrQsNC6INC60L7Qu9C70LHQtdC6INCyINC00LjRgNC10LrRgtC40LLRgyBkci1ib29rLWNhcmQgPT4gZWRpdC1ib29rLWNiXG4gICogQHBhcmFtIGJvb2tcbiAgKi9cblx0Ym9va3NMaXN0Q3RybC5wcm90b3R5cGUuZWRpdEJvb2sgPSBmdW5jdGlvbiAoYm9vaykge1xuXHRcdHRoaXMubG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ2VkaXRCb29rJywgYm9vayk7XG5cdFx0dGhpcy4kc3RhdGUuZ28oJ21haW4uZWRpdCcsIHsgaWQ6IGJvb2suaWQgfSk7XG5cdH07XG5cblx0LyoqXG4gICog0KTRg9C90LrRhtC40Y8g0YPQtNCw0LvQtdC90LjRjyDQutC90LjQs9C4XG4gICog0J/QtdGA0LXQtNCw0LXRgtGB0Y8g0LrQsNC6INC60L7Qu9C70LHQtdC6INCyINC00LjRgNC10LrRgtC40LLRgyBkci1ib29rLWNhcmQgPT4gZGVsZXRlLWJvb2stY2JcbiAgKiBAcGFyYW0gYm9va1xuICAqL1xuXHRib29rc0xpc3RDdHJsLnByb3RvdHlwZS5kZWxldGVCb29rID0gZnVuY3Rpb24gKGJvb2spIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYm9va0xpc3QubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdGlmIChib29rLmlkID09PSB0aGlzLmJvb2tMaXN0W2ldLmlkKSB0aGlzLmJvb2tMaXN0LnNwbGljZShpLCAxKTtcblx0XHR9XG5cdFx0dGhpcy5sb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnYm9va0xpc3QnLCB0aGlzLmJvb2tMaXN0KTtcblx0fTtcblxuXHQvKipcbiAgKiDQpNGD0L3QutGG0LjRjyDQtNC+0LHQsNCy0LvQtdC90LjRjyDQutC90LjQs9C4XG4gICovXG5cdGJvb2tzTGlzdEN0cmwucHJvdG90eXBlLmFkZEJvb2sgPSBmdW5jdGlvbiAoZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0dGhpcy4kc3RhdGUuZ28oJ21haW4uY3JlYXRlJyk7XG5cdH07XG5cblx0LyoqXG4gICog0KTRg9C90LrRhtC40Y8g0YHQvtGA0YLQuNGA0L7QstC60Lgg0LrQvdC40LMg0L/QviDQutC70LjQutGDINC90LAg0YTQuNC70YzRgtGAXG4gICog0J/QtdGA0LXQtNCw0LXRgtGB0Y8g0LrQsNC6INC60L7Qu9C70LHQtdC6INCyINC00LjRgNC10LrRgtC40LLRgyBkci1zb3J0LWJvb2tzID0+IGNsaWNrLWNiXG4gICovXG5cdGJvb2tzTGlzdEN0cmwucHJvdG90eXBlLnNvcnRCb29rcyA9IGZ1bmN0aW9uICh0eXBlKSB7XG5cdFx0Y29uc29sZS5sb2coJy0tLT09PSB0eXBlID09PS0tLScsIHR5cGUpO1xuXHRcdGlmICh0aGlzLnNvcnRUeXBlID09PSB0eXBlKSB7XG5cdFx0XHR0aGlzLnNvcnRSZXZlcnNlID0gIXRoaXMuc29ydFJldmVyc2U7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuc29ydFJldmVyc2UgPSBmYWxzZTtcblx0XHRcdHRoaXMuc29ydFR5cGUgPSB0eXBlO1xuXHRcdH1cblxuXHRcdHRoaXMubG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ3NvcnRDb25mJywgeyB0eXBlOiB0aGlzLnNvcnRUeXBlLCByZXZlcnNlOiB0aGlzLnNvcnRSZXZlcnNlIH0pO1xuXHR9O1xuXG5cdGJvb2tzTGlzdEN0cmwucHJvdG90eXBlLnVwZGF0ZUZyb21Kc29uID0gZnVuY3Rpb24gKGUpIHtcblx0XHR2YXIgX3RoaXMgPSB0aGlzO1xuXG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHR0aGlzLiRodHRwLmdldCgnLi9zcmMvZml4dHVyZXMvYm9va3MuanNvbicpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcmVzcC5kYXRhLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdHJlc3AuZGF0YVtpXS5fYXV0aG9yID0gcmVzcC5kYXRhW2ldLmF1dGhvcnNbMF1bJ3NfbmFtZSddO1xuXHRcdFx0fVxuXHRcdFx0X3RoaXMubG9jYWxTdG9yYWdlU2VydmljZS5zZXQoJ2Jvb2tMaXN0JywgcmVzcC5kYXRhKTtcblx0XHRcdF90aGlzLiRzdGF0ZS5yZWxvYWQoKTtcblx0XHR9KTtcblx0fTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignQ3JlYXRlQm9va0N0cmwnLCBDcmVhdGVCb29rQ3RybCk7XG5cblx0Q3JlYXRlQm9va0N0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJyRodHRwJywgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnbG9jYWxTdG9yYWdlU2VydmljZSddO1xuXG5cdGZ1bmN0aW9uIENyZWF0ZUJvb2tDdHJsKCRzY29wZSwgJGh0dHAsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCBsb2NhbFN0b3JhZ2VTZXJ2aWNlKSB7XG5cdFx0dGhpcy4kc2NvcGUgPSAkc2NvcGU7XG5cdFx0dGhpcy4kaHR0cCA9ICRodHRwO1xuXHRcdHRoaXMuJHN0YXRlID0gJHN0YXRlO1xuXHRcdHRoaXMubG9jYWxTdG9yYWdlU2VydmljZSA9IGxvY2FsU3RvcmFnZVNlcnZpY2U7XG5cblx0XHR0aGlzLmluaXQoKTtcblx0fVxuXG5cdENyZWF0ZUJvb2tDdHJsLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuXHRcdHRoaXMuYm9vayA9IGFuZ3VsYXIuY29weSh0aGlzLmxvY2FsU3RvcmFnZVNlcnZpY2UuZ2V0KCdlZGl0Qm9vaycpKTtcblx0fTtcblxuXHRDcmVhdGVCb29rQ3RybC5wcm90b3R5cGUuc2F2ZUJvb2tDYiA9IGZ1bmN0aW9uIChuZXdCb29rKSB7XG5cdFx0dmFyIGJvb2tzID0gdGhpcy5sb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgnYm9va0xpc3QnKTtcblx0XHRuZXdCb29rLmlkID0gJ18nICsgYm9va3MubGVuZ3RoO1xuXHRcdGJvb2tzLnB1c2gobmV3Qm9vayk7XG5cdFx0dGhpcy5sb2NhbFN0b3JhZ2VTZXJ2aWNlLnNldCgnYm9va0xpc3QnLCBib29rcyk7XG5cdFx0dGhpcy4kc3RhdGUuZ28oJ21haW4nKTtcblx0fTtcbn0pKCk7XG4ndXNlIHN0cmljdCc7XG5cbihmdW5jdGlvbiAoKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuXHRhbmd1bGFyLm1vZHVsZSgnYXBwJykuY29udHJvbGxlcignRWRpdEJvb2tDdHJsJywgRWRpdEJvb2tDdHJsKTtcblxuXHRFZGl0Qm9va0N0cmwuJGluamVjdCA9IFsnJHNjb3BlJywgJyRodHRwJywgJyRzdGF0ZScsICckc3RhdGVQYXJhbXMnLCAnbG9jYWxTdG9yYWdlU2VydmljZSddO1xuXG5cdGZ1bmN0aW9uIEVkaXRCb29rQ3RybCgkc2NvcGUsICRodHRwLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgbG9jYWxTdG9yYWdlU2VydmljZSkge1xuXHRcdHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuXHRcdHRoaXMuJGh0dHAgPSAkaHR0cDtcblx0XHR0aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcblx0XHR0aGlzLmxvY2FsU3RvcmFnZVNlcnZpY2UgPSBsb2NhbFN0b3JhZ2VTZXJ2aWNlO1xuXG5cdFx0dGhpcy5pbml0KCk7XG5cdH1cblxuXHRFZGl0Qm9va0N0cmwucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0dGhpcy5ib29rID0gYW5ndWxhci5jb3B5KHRoaXMubG9jYWxTdG9yYWdlU2VydmljZS5nZXQoJ2VkaXRCb29rJykpO1xuXHR9O1xuXG5cdEVkaXRCb29rQ3RybC5wcm90b3R5cGUuc2F2ZUJvb2tDYiA9IGZ1bmN0aW9uICgpIHtcblx0XHRjb25zb2xlLmxvZygnLS0tPT09IGNhbGxiYWNrID09PS0tLScpO1xuXG5cdFx0dmFyIGJvb2tzID0gdGhpcy5sb2NhbFN0b3JhZ2VTZXJ2aWNlLmdldCgnYm9va0xpc3QnKTtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGJvb2tzLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRpZiAodGhpcy5ib29rLmlkID09IGJvb2tzW2ldLmlkKSB7XG5cdFx0XHRcdGJvb2tzW2ldID0gdGhpcy5ib29rO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR0aGlzLmxvY2FsU3RvcmFnZVNlcnZpY2Uuc2V0KCdib29rTGlzdCcsIGJvb2tzKTtcblx0XHR0aGlzLmxvY2FsU3RvcmFnZVNlcnZpY2UucmVtb3ZlKCdlZGl0Qm9vaycpO1xuXHRcdHRoaXMuJHN0YXRlLmdvKCdtYWluJyk7XG5cdH07XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24gKCkge1xuXHQndXNlIHN0cmljdCc7XG5cblx0YW5ndWxhci5tb2R1bGUoJ2FwcCcpLmNvbnRyb2xsZXIoJ21haW5DdHJsJywgbWFpbkN0cmwpO1xuXG5cdG1haW5DdHJsLiRpbmplY3QgPSBbJyRzY29wZScsICckaHR0cCcsICckc3RhdGUnLCAnJHN0YXRlUGFyYW1zJywgJ2xvY2FsU3RvcmFnZVNlcnZpY2UnXTtcblxuXHRmdW5jdGlvbiBtYWluQ3RybCgkc2NvcGUsICRodHRwLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgbG9jYWxTdG9yYWdlU2VydmljZSkge1xuXHRcdHRoaXMuJHNjb3BlID0gJHNjb3BlO1xuXHRcdHRoaXMuJGh0dHAgPSAkaHR0cDtcblx0XHR0aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcblx0XHR0aGlzLmxvY2FsU3RvcmFnZVNlcnZpY2UgPSBsb2NhbFN0b3JhZ2VTZXJ2aWNlO1xuXG5cdFx0dGhpcy5pbml0KCk7XG5cdH1cblxuXHRtYWluQ3RybC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uICgpIHtcblx0XHR0aGlzLmdldEJvb2tzKCk7XG5cdH07XG5cblx0bWFpbkN0cmwucHJvdG90eXBlLmdldEJvb2tzID0gZnVuY3Rpb24gKCkge1xuXHRcdHZhciBfdGhpcyA9IHRoaXM7XG5cblx0XHRpZiAoIXRoaXMubG9jYWxTdG9yYWdlU2VydmljZS5nZXQoJ2Jvb2tMaXN0JykpIHtcblx0XHRcdHRoaXMuJGh0dHAuZ2V0KCcuL3NyYy9maXh0dXJlcy9ib29rcy5qc29uJykudGhlbihmdW5jdGlvbiAocmVzcCkge1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHJlc3AuZGF0YS5sZW5ndGg7IGkgKz0gMSkge1xuXHRcdFx0XHRcdHJlc3AuZGF0YVtpXS5fYXV0aG9yID0gcmVzcC5kYXRhW2ldLmF1dGhvcnNbMF1bJ3NfbmFtZSddO1xuXHRcdFx0XHR9XG5cdFx0XHRcdF90aGlzLmxvY2FsU3RvcmFnZVNlcnZpY2Uuc2V0KCdib29rTGlzdCcsIHJlc3AuZGF0YSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG59KSgpOyJdfQ==
